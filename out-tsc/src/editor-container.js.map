{"version":3,"file":"editor-container.js","sourceRoot":"","sources":["../../src/editor-container.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  css,\n  customElement,\n  html,\n  internalProperty,\n  LitElement,\n  property,\n  query,\n  TemplateResult,\n} from 'lit-element';\nimport { classMap } from 'lit-html/directives/class-map';\n\nimport { newWizardEvent, SCLTag, tags } from './foundation.js';\n\nimport { emptyWizard, wizards } from './wizards/wizard-library.js';\n\nimport { Menu } from '@material/mwc-menu';\nimport { IconButton } from '@material/mwc-icon-button';\nimport { ListItem } from '@material/mwc-list/mwc-list-item';\n\nfunction childTags(element: Element | null | undefined): SCLTag[] {\n  if (!element) return [];\n\n  return tags[<SCLTag>element.tagName].children.filter(\n    child => wizards[child].create !== emptyWizard\n  );\n}\n\n/**\n * A responsive container for nested elements with header and\n * create new child functionality.\n */\n@customElement('editor-container')\nexport class EditorContainer extends LitElement {\n  /** The visualized `Element`. */\n  @property()\n  element: Element | null = null;\n  /**Overwrites default header text*/\n  @property({ type: String })\n  header = '';\n  /** Sets the header type h1, h2, h3, h4, h5 or h6 */\n  @property({ type: Number })\n  level: 1 | 2 | 3 | 4 | 5 | 6 = 1;\n  /** Sets the focused header color */\n  @property({ type: Boolean })\n  secondary = false;\n  /** Whether different background color shall be used */\n  @property({ type: Boolean })\n  contrasted = false;\n  /** Wether outline shall be permanent */\n  @property({ type: Boolean })\n  highlighted = false;\n  /** Whether the container does not have margins*/\n  @property({ type: Boolean })\n  nomargin = false;\n\n  @internalProperty()\n  get defaultHeader(): string {\n    const name = this.element?.getAttribute('name') ?? '';\n    const desc = this.element?.getAttribute('desc');\n\n    return `${name}${desc ? ` - ${desc}` : ''}`;\n  }\n\n  @query('mwc-icon-button[icon=\"playlist_add\"]') addIcon?: IconButton;\n  @query('#menu') addMenu!: Menu;\n  @query('#header') headerContainer!: HTMLElement;\n  @query('#morevert > mwc-icon-button') moreVert?: IconButton;\n  @query('.container') container!: HTMLElement;\n\n  private openCreateWizard(tagName: string): void {\n    const wizard = wizards[<SCLTag>tagName].create(this.element!);\n\n    if (wizard) this.dispatchEvent(newWizardEvent(wizard));\n  }\n\n  async firstUpdated(): Promise<void> {\n    await super.updateComplete;\n    if (this.addMenu) this.addMenu.anchor = this.headerContainer;\n    const parentEditorContainer =\n      <EditorContainer>(\n        (<ShadowRoot>this.parentNode).host?.closest('editor-container')\n      ) ?? null;\n\n    if (!parentEditorContainer) return;\n\n    this.level = <1 | 2 | 3 | 4 | 5 | 6>(\n      Math.min(parentEditorContainer.level + 1, 6)\n    );\n\n    this.contrasted = !parentEditorContainer.contrasted;\n  }\n\n  private renderAddButtons(): TemplateResult[] {\n    return childTags(this.element).map(\n      child =>\n        html`<mwc-list-item value=\"${child}\"\n          ><span>${child}</span></mwc-list-item\n        >`\n    );\n  }\n\n  private styleFabButtonTransform(): string[] {\n    let transform = 0;\n    return Array.from(this.children).map((child, i) => {\n      if (child.tagName === 'MWC-FAB')\n        return `#morevert:focus-within >\n        ::slotted(mwc-fab:nth-child(${i + 1})) { transform: translate(0,\n        ${++transform * 48}px); }`;\n      return ``;\n    });\n  }\n\n  private renderHeaderBody(): TemplateResult {\n    return html`${this.header !== '' ? this.header : this.defaultHeader}\n      ${childTags(this.element).length\n        ? html`<mwc-icon-button\n              icon=\"playlist_add\"\n              @click=${() => (this.addMenu.open = true)}\n            ></mwc-icon-button>\n            <mwc-menu\n              id=\"menu\"\n              corner=\"TOP_RIGHT\"\n              menuCorner=\"END\"\n              @selected=${(e: Event) => {\n                const tagName = (<ListItem>(<Menu>e.target).selected).value;\n                this.openCreateWizard(tagName);\n              }}\n              >${this.renderAddButtons()}\n            </mwc-menu>`\n        : html``}\n      ${Array.from(this.children).some(child => child.tagName === 'MWC-FAB')\n        ? html`<div id=\"morevert\">\n            <mwc-icon-button icon=\"more_vert\"></mwc-icon-button>\n            <slot name=\"morevert\"></slot>\n          </div>`\n        : html``}<style>\n        ${childTags(this.element).length\n          ? html`::slotted(mwc-fab) {right: 48px;}`\n          : html`::slotted(mwc-fab) {right: 0px;}`}\n          ${this.styleFabButtonTransform()}\n      </style>\n      <nav><slot name=\"header\"></slot></nav>`;\n  }\n\n  private renderHeader(): TemplateResult {\n    let header = html``;\n\n    switch (this.level) {\n      case 1:\n        header = html`<h1>${this.renderHeaderBody()}</h1>`;\n        break;\n      case 2:\n        header = html`<h2>${this.renderHeaderBody()}</h2>`;\n        break;\n      case 3:\n        header = html`<h3>${this.renderHeaderBody()}</h3>`;\n        break;\n      case 4:\n        header = html`<h4>${this.renderHeaderBody()}</h4>`;\n        break;\n      case 5:\n        header = html`<h5>${this.renderHeaderBody()}</h5>`;\n        break;\n      case 6:\n        header = html`<h6>${this.renderHeaderBody()}</h6>`;\n    }\n\n    return html`<div id=\"header\">${header}</div>`;\n  }\n\n  render(): TemplateResult {\n    return html`<section\n      class=\"${classMap({\n        container: true,\n        secondary: this.secondary,\n        highlighted: this.highlighted,\n        contrasted: this.contrasted,\n        nomargin: this.nomargin,\n      })}\"\n      tabindex=\"0\"\n    >\n      ${this.renderHeader()}\n      <slot name=\"container\"></slot>\n    </section>`;\n  }\n\n  static styles = css`\n    :host(.moving) section {\n      opacity: 0.3;\n    }\n\n    .container {\n      background-color: var(--mdc-theme-surface);\n      transition: all 200ms linear;\n      outline-style: solid;\n      margin: 8px 12px 16px;\n      padding: 0.02px; /*Dirty hack to force outline around content with margin*/\n      outline-width: 0px;\n      outline-color: var(--mdc-theme-primary);\n      opacity: 1;\n    }\n\n    .container.secondary {\n      outline-color: var(--mdc-theme-secondary);\n    }\n\n    .highlighted {\n      outline-width: 2px;\n    }\n\n    .contrasted {\n      background-color: var(--mdc-theme-on-primary);\n    }\n\n    .nomargin {\n      margin: 0px;\n    }\n\n    .container:focus {\n      box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14),\n        0 3px 14px 2px rgba(0, 0, 0, 0.12), 0 5px 5px -3px rgba(0, 0, 0, 0.2);\n    }\n\n    .container:focus-within {\n      outline-width: 2px;\n      transition: all 250ms linear;\n    }\n\n    .container:focus-within h1,\n    .container:focus-within h2,\n    .container:focus-within h3 {\n      color: var(--mdc-theme-surface);\n      transition: background-color 200ms linear;\n    }\n\n    .container:focus-within h1,\n    .container:focus-within h2,\n    .container:focus-within h3 {\n      background-color: var(--mdc-theme-primary);\n    }\n\n    .container.secondary:focus-within h1,\n    .container.secondary:focus-within h2,\n    .container.secondary:focus-within h3 {\n      background-color: var(--mdc-theme-secondary);\n    }\n\n    h1,\n    h2,\n    h3 {\n      color: var(--mdc-theme-on-surface);\n      font-family: 'Roboto', sans-serif;\n      font-weight: 300;\n      overflow: hidden;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      margin: 0px;\n      line-height: 48px;\n      padding-left: 0.3em;\n      transition: background-color 150ms linear;\n    }\n\n    h1 > ::slotted(mwc-icon-button),\n    h2 > ::slotted(mwc-icon-button),\n    h3 > ::slotted(mwc-icon-button),\n    h1 > ::slotted(abbr),\n    h2 > ::slotted(abbr),\n    h3 > ::slotted(abbr) {\n      float: right;\n    }\n\n    h1 > nav,\n    h2 > nav,\n    h3 > nav {\n      float: right;\n    }\n\n    h1 > mwc-icon-button,\n    h2 > mwc-icon-button,\n    h3 > mwc-icon-button {\n      float: right;\n    }\n\n    #morevert {\n      float: right;\n    }\n\n    #header {\n      position: relative;\n    }\n\n    abbr {\n      text-decoration: none;\n      border-bottom: none;\n    }\n\n    ::slotted(mwc-fab) {\n      color: var(--mdc-theme-on-surface);\n      opacity: 0;\n      position: absolute;\n      pointer-events: none;\n      z-index: 1;\n      transition: transform 200ms cubic-bezier(0.4, 0, 0.2, 1),\n        opacity 200ms linear;\n    }\n\n    #morevert:focus-within > ::slotted(mwc-fab) {\n      transition: transform 250ms cubic-bezier(0.4, 0, 0.2, 1),\n        opacity 250ms linear;\n      pointer-events: auto;\n      opacity: 1;\n    }\n  `;\n}\n"]}