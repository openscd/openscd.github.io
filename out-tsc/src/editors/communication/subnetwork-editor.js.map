{"version":3,"file":"subnetwork-editor.js","sourceRoot":"","sources":["../../../../src/editors/communication/subnetwork-editor.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  LitElement,\n  TemplateResult,\n  customElement,\n  html,\n  property,\n  css,\n} from 'lit-element';\nimport { translate, get } from 'lit-translate';\n\nimport {\n  EditorAction,\n  newWizardEvent,\n  Wizard,\n  WizardActor,\n  WizardInput,\n  newActionEvent,\n  getValue,\n  getMultiplier,\n  patterns,\n  compareNames,\n  createElement,\n  getReference,\n  cloneElement,\n} from '../../foundation.js';\n\nimport { styles, WizardOptions, isCreateOptions } from './foundation.js';\n\nimport './connectedap-editor.js';\nimport { createConnectedApWizard } from './connectedap-editor.js';\n\n/** Initial attribute values suggested for `SubNetwork` creation */\nconst initial = {\n  type: '8-MMS',\n  bitrate: '100',\n  multiplier: 'M',\n};\n\nfunction getBitRateAction(\n  oldBitRate: Element | null,\n  BitRate: string | null,\n  multiplier: string | null,\n  SubNetwork: Element\n): EditorAction {\n  if (oldBitRate === null)\n    return {\n      new: {\n        parent: SubNetwork,\n        element: new DOMParser().parseFromString(\n          `<BitRate unit=\"b/s\" ${\n            multiplier === null ? '' : `multiplier=\"${multiplier}\"`\n          }>${BitRate === null ? '' : BitRate}</BitRate>`,\n          'application/xml'\n        ).documentElement,\n        reference: SubNetwork.firstElementChild,\n      },\n    };\n\n  if (BitRate === null)\n    return {\n      old: {\n        parent: SubNetwork,\n        element: oldBitRate,\n        reference: oldBitRate.nextSibling,\n      },\n    };\n\n  const newBitRate = cloneElement(oldBitRate, { multiplier });\n  newBitRate.textContent = BitRate;\n\n  return {\n    old: { element: oldBitRate },\n    new: { element: newBitRate },\n  };\n}\n\nexport function updateSubNetworkAction(element: Element): WizardActor {\n  return (inputs: WizardInput[], wizard: Element): EditorAction[] => {\n    const name = inputs.find(i => i.label === 'name')!.value!;\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n    const type = getValue(inputs.find(i => i.label === 'type')!);\n    const BitRate = getValue(inputs.find(i => i.label === 'BitRate')!);\n    const multiplier = getMultiplier(inputs.find(i => i.label === 'BitRate')!);\n\n    let subNetworkAction: EditorAction | null;\n    let bitRateAction: EditorAction | null;\n\n    if (\n      name === element.getAttribute('name') &&\n      desc === element.getAttribute('desc') &&\n      type === element.getAttribute('type')\n    ) {\n      subNetworkAction = null;\n    } else {\n      const newElement = cloneElement(element, { name, desc, type });\n      subNetworkAction = { old: { element }, new: { element: newElement } };\n    }\n\n    if (\n      BitRate ===\n        (element.querySelector('SubNetwork > BitRate')?.textContent?.trim() ??\n          null) &&\n      multiplier ===\n        (element\n          .querySelector('SubNetwork > BitRate')\n          ?.getAttribute('multiplier') ?? null)\n    ) {\n      bitRateAction = null;\n    } else {\n      bitRateAction = getBitRateAction(\n        element.querySelector('SubNetwork > BitRate'),\n        BitRate,\n        multiplier,\n        subNetworkAction?.new.element ?? element\n      );\n    }\n\n    const actions: EditorAction[] = [];\n    if (subNetworkAction) actions.push(subNetworkAction);\n    if (bitRateAction) actions.push(bitRateAction);\n    return actions;\n  };\n}\n\nexport function createSubNetworkAction(parent: Element): WizardActor {\n  return (inputs: WizardInput[], wizard: Element): EditorAction[] => {\n    const name = getValue(inputs.find(i => i.label === 'name')!);\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n    const type = getValue(inputs.find(i => i.label === 'type')!);\n    const BitRate = getValue(inputs.find(i => i.label === 'BitRate')!);\n    const multiplier = getMultiplier(inputs.find(i => i.label === 'BitRate')!);\n\n    const element = createElement(parent.ownerDocument, 'SubNetwork', {\n      name,\n      desc,\n      type,\n    });\n\n    if (BitRate !== null) {\n      const bitRateElement = createElement(parent.ownerDocument, 'BitRate', {\n        unit: 'b/s',\n        multiplier,\n      });\n      bitRateElement.textContent = BitRate;\n      element.appendChild(bitRateElement);\n    }\n\n    const action = {\n      new: {\n        parent,\n        element,\n        reference: getReference(parent, 'SubNetwork'),\n      },\n    };\n\n    return [action];\n  };\n}\n\nexport function subNetworkWizard(options: WizardOptions): Wizard {\n  const [\n    heading,\n    actionName,\n    actionIcon,\n    action,\n    name,\n    desc,\n    type,\n    BitRate,\n    multiplier,\n    element,\n  ] = isCreateOptions(options)\n    ? [\n        get('subnetwork.wizard.title.add'),\n        get('add'),\n        'add',\n        createSubNetworkAction(options.parent),\n        '',\n        '',\n        initial.type,\n        initial.bitrate,\n        initial.multiplier,\n        undefined,\n      ]\n    : [\n        get('subnetwork.wizard.title.edit'),\n        get('save'),\n        'edit',\n        updateSubNetworkAction(options.element),\n        options.element.getAttribute('name'),\n        options.element.getAttribute('desc'),\n        options.element.getAttribute('type'),\n        options.element\n          .querySelector('SubNetwork > BitRate')\n          ?.textContent?.trim() ?? null,\n        options.element\n          .querySelector('SubNetwork > BitRate')\n          ?.getAttribute('multiplier') ?? null,\n        options.element,\n      ];\n\n  return [\n    {\n      title: heading,\n      element,\n      primary: {\n        icon: actionIcon,\n        label: actionName,\n        action: action,\n      },\n      content: [\n        html`<wizard-textfield\n          label=\"name\"\n          .maybeValue=${name}\n          helper=\"${translate('subnetwork.wizard.nameHelper')}\"\n          required\n          validationMessage=\"${translate('textfield.required')}\"\n          dialogInitialFocus\n        ></wizard-textfield>`,\n        html`<wizard-textfield\n          label=\"desc\"\n          .maybeValue=${desc}\n          nullable\n          helper=\"${translate('subnetwork.wizard.descHelper')}\"\n        ></wizard-textfield>`,\n        html`<wizard-textfield\n          label=\"type\"\n          .maybeValue=${type}\n          nullable\n          helper=\"${translate('subnetwork.wizard.typeHelper')}\"\n          pattern=\"${patterns.normalizedString}\"\n        ></wizard-textfield>`,\n        html`<wizard-textfield\n          label=\"BitRate\"\n          .maybeValue=${BitRate}\n          nullable\n          unit=\"b/s\"\n          .multipliers=${[null, 'M']}\n          .multiplier=${multiplier}\n          helper=\"${translate('subnetwork.wizard.bitrateHelper')}\"\n          required\n          validationMessage=\"${translate('textfield.nonempty')}\"\n          pattern=\"${patterns.decimal}\"\n        ></wizard-textfield>`,\n      ],\n    },\n  ];\n}\n\n/** [[`Communication`]] subeditor for a `SubNetwork` element. */\n@customElement('subnetwork-editor')\nexport class SubNetworkEditor extends LitElement {\n  @property()\n  element!: Element;\n\n  @property()\n  get name(): string {\n    return this.element.getAttribute('name') ?? '';\n  }\n  @property()\n  get desc(): string | null {\n    return this.element.getAttribute('desc') ?? null;\n  }\n  @property()\n  get type(): string | null {\n    return this.element.getAttribute('type') ?? null;\n  }\n  @property()\n  get bitrate(): string | null {\n    const V = this.element.querySelector('BitRate');\n    if (V === null) return null;\n    const v = V.textContent ?? '';\n    const m = V.getAttribute('multiplier');\n    const u = m === null ? 'b/s' : ' ' + m + 'b/s';\n    return v ? v + u : null;\n  }\n\n  openConnectedAPwizard(): void {\n    this.dispatchEvent(newWizardEvent(createConnectedApWizard(this.element)));\n  }\n\n  openEditWizard(): void {\n    this.dispatchEvent(\n      newWizardEvent(subNetworkWizard({ element: this.element }))\n    );\n  }\n\n  remove(): void {\n    if (this.element)\n      this.dispatchEvent(\n        newActionEvent({\n          old: {\n            parent: this.element.parentElement!,\n            element: this.element,\n            reference: this.element.nextSibling,\n          },\n        })\n      );\n  }\n\n  renderSubNetworkSpecs(): TemplateResult {\n    if (!this.type && !this.bitrate) return html``;\n\n    return html`(${this.type}${this.type && this.bitrate\n      ? html`&mdash;`\n      : html``}${this.bitrate})`;\n  }\n\n  renderHeader(): TemplateResult {\n    return html`<h1>\n      ${this.name} ${this.desc === null ? '' : html`&mdash;`} ${this.desc}\n      ${this.renderSubNetworkSpecs()}\n      <abbr title=\"${translate('add')}\">\n        <mwc-icon-button\n          icon=\"playlist_add\"\n          @click=\"${() => this.openConnectedAPwizard()}\"\n        ></mwc-icon-button>\n      </abbr>\n      <nav>\n        <abbr title=\"${translate('edit')}\">\n          <mwc-icon-button\n            icon=\"edit\"\n            @click=${() => this.openEditWizard()}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('remove')}\">\n          <mwc-icon-button\n            icon=\"delete\"\n            @click=${() => this.remove()}\n          ></mwc-icon-button>\n        </abbr>\n      </nav>\n    </h1>`;\n  }\n\n  renderIedContainer(): TemplateResult[] {\n    return Array.from(this.element.querySelectorAll('ConnectedAP') ?? [])\n      .map(connAP => connAP.getAttribute('iedName')!)\n      .filter((v, i, a) => a.indexOf(v) === i)\n      .sort(compareNames)\n      .map(\n        iedName => html` <section id=\"iedSection\" tabindex=\"0\">\n          <h3>${iedName}</h3>\n          <div id=\"connApContainer\">\n            ${Array.from(\n              this.element.ownerDocument.querySelectorAll(\n                `ConnectedAP[iedName=\"${iedName}\"]`\n              )\n            ).map(\n              connectedAP =>\n                html`<connectedap-editor\n                  class=\"${connectedAP.parentElement !== this.element\n                    ? 'disabled'\n                    : ''}\"\n                  .element=${connectedAP}\n                ></connectedap-editor>`\n            )}\n          </div>\n        </section>`\n      );\n  }\n\n  render(): TemplateResult {\n    return html`<section tabindex=\"0\">\n      ${this.renderHeader()}\n      <div id=\"connAPContainer\">${this.renderIedContainer()}</div>\n    </section>`;\n  }\n\n  static styles = css`\n    ${styles}\n\n    #iedSection {\n      background-color: var(--mdc-theme-on-primary);\n      margin: 0px;\n    }\n\n    #iedSection:not(:focus):not(:focus-within) .disabled {\n      display: none;\n    }\n\n    #iedSection .disabled {\n      pointer-events: none;\n      opacity: 0.5;\n    }\n\n    #connAPContainer {\n      display: grid;\n      box-sizing: border-box;\n      gap: 12px;\n      padding: 8px 12px 16px;\n      grid-template-columns: repeat(auto-fit, minmax(150px, auto));\n    }\n\n    #connApContainer {\n      display: grid;\n      box-sizing: border-box;\n      padding: 8px 12px 8px;\n      grid-template-columns: repeat(auto-fit, minmax(64px, auto));\n    }\n  `;\n}\n"]}