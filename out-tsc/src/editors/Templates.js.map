{"version":3,"file":"Templates.js","sourceRoot":"","sources":["../../../src/editors/Templates.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html, TemplateResult, property, css } from 'lit-element';\nimport { translate } from 'lit-translate';\n\nimport {\n  getReference,\n  identity,\n  newActionEvent,\n  newWizardEvent,\n} from '../foundation.js';\n\nimport { styles } from './templates/foundation.js';\n\nimport '../filtered-list.js';\nimport './templates/enum-type-editor.js';\nimport {\n  createDATypeWizard,\n  dATypeWizard,\n} from './templates/datype-wizards.js';\n\nimport { EnumTypeEditor } from './templates/enum-type-editor.js';\nimport { List } from '@material/mwc-list';\nimport { ListItem } from '@material/mwc-list/mwc-list-item';\nimport { SingleSelectedEvent } from '@material/mwc-list/mwc-list-foundation';\n\nconst templates = fetch('public/xml/templates.scd')\n  .then(response => response.text())\n  .then(str => new DOMParser().parseFromString(str, 'application/xml'));\n\n/** An editor [[`plugin`]] for editing the `DataTypeTemplates` section. */\nexport default class TemplatesPlugin extends LitElement {\n  /** The document being edited as provided to plugins by [[`OpenSCD`]]. */\n  @property()\n  doc!: XMLDocument;\n\n  openDATypeWizard(identity: string): void {\n    const wizard = dATypeWizard(identity, this.doc);\n    if (wizard) this.dispatchEvent(newWizardEvent(wizard));\n  }\n\n  /** Opens a [[`WizardDialog`]] for creating a new `Substation` element. */\n  async openCreateDATypeWizard(): Promise<void> {\n    this.createDataTypeTemplates();\n\n    this.dispatchEvent(\n      newWizardEvent(\n        createDATypeWizard(\n          this.doc.querySelector(':root > DataTypeTemplates')!,\n          await templates\n        )\n      )\n    );\n  }\n\n  /** Opens a [[`WizardDialog`]] for creating a new `Substation` element. */\n  async openCreateEnumWizard(): Promise<void> {\n    this.createDataTypeTemplates();\n\n    this.dispatchEvent(\n      newWizardEvent(\n        EnumTypeEditor.wizard({\n          parent: this.doc.querySelector(':root > DataTypeTemplates')!,\n          templates: await templates,\n        })\n      )\n    );\n  }\n\n  createDataTypeTemplates(): void {\n    if (!this.doc.querySelector(':root > DataTypeTemplates'))\n      this.dispatchEvent(\n        newActionEvent({\n          new: {\n            parent: this.doc.documentElement,\n            element: this.doc.createElement('DataTypeTemplates'),\n            reference: getReference(\n              this.doc.documentElement,\n              'DataTypeTemplates'\n            ),\n          },\n        })\n      );\n  }\n\n  render(): TemplateResult {\n    if (!this.doc?.querySelector(':root > DataTypeTemplates'))\n      return html`<h1>\n        <span style=\"color: var(--base1)\"\n          >${translate('templates.missing')}</span\n        >\n        <mwc-fab\n          extended\n          icon=\"add\"\n          label=\"${translate('templates.add')}\"\n          @click=${() => this.createDataTypeTemplates()}\n        ></mwc-fab>\n      </h1>`;\n    return html`\n      <div id=\"containerTemplates\">\n        <section tabindex=\"0\">\n          <h1>\n            ${translate('scl.DAType')}\n            <nav>\n              <abbr title=\"${translate('add')}\">\n                <mwc-icon-button\n                  icon=\"playlist_add\"\n                  @click=${() => this.openCreateDATypeWizard()}\n                ></mwc-icon-button>\n              </abbr>\n            </nav>\n          </h1>\n          <filtered-list\n            id=\"datypelist\"\n            @selected=${(e: SingleSelectedEvent) =>\n              this.openDATypeWizard(\n                (<ListItem>(<List>e.target).selected).value\n              )}\n          >\n            ${Array.from(\n              this.doc.querySelectorAll(':root > DataTypeTemplates > DAType') ??\n                []\n            ).map(\n              datype =>\n                html`<mwc-list-item\n                  value=\"${identity(datype)}\"\n                  tabindex=\"0\"\n                  hasMeta\n                  ><span>${datype.getAttribute('id')}</span\n                  ><span slot=\"meta\"\n                    >${datype.querySelectorAll('BDA').length}</span\n                  ></mwc-list-item\n                >`\n            )}\n          </filtered-list>\n        </section>\n        <section tabindex=\"0\">\n          <h1>\n            ${translate('scl.EnumType')}\n            <nav>\n              <abbr title=\"${translate('add')}\">\n                <mwc-icon-button\n                  icon=\"playlist_add\"\n                  @click=${() => this.openCreateEnumWizard()}\n                ></mwc-icon-button>\n              </abbr>\n            </nav>\n          </h1>\n          <mwc-list>\n            ${Array.from(\n              this.doc.querySelectorAll(\n                ':root > DataTypeTemplates > EnumType'\n              ) ?? []\n            ).map(\n              enumType =>\n                html`<enum-type-editor .element=${enumType}></enum-type-editor>`\n            )}\n          </mwc-list>\n        </section>\n      </div>\n    `;\n  }\n\n  static styles = css`\n    ${styles}\n\n    mwc-fab {\n      position: fixed;\n      bottom: 32px;\n      right: 32px;\n    }\n\n    :host {\n      width: 100vw;\n    }\n\n    #containerTemplates {\n      display: grid;\n      grid-gap: 12px;\n      padding: 8px 12px 16px;\n      box-sizing: border-box;\n      grid-template-columns: repeat(auto-fit, minmax(400px, auto));\n    }\n\n    @media (max-width: 387px) {\n      #containerTemplates {\n        grid-template-columns: repeat(auto-fit, minmax(196px, auto));\n      }\n    }\n  `;\n}\n"]}