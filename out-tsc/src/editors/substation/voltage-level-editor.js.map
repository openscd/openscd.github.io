{"version":3,"file":"voltage-level-editor.js","sourceRoot":"","sources":["../../../../src/editors/substation/voltage-level-editor.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  LitElement,\n  TemplateResult,\n  customElement,\n  html,\n  property,\n  css,\n} from 'lit-element';\nimport { translate, get } from 'lit-translate';\n\nimport {\n  createElement,\n  EditorAction,\n  getMultiplier,\n  getReference,\n  getValue,\n  newActionEvent,\n  newWizardEvent,\n  patterns,\n  Wizard,\n  WizardActor,\n  WizardInput,\n} from '../../foundation.js';\n\nimport {\n  isCreateOptions,\n  selectors,\n  startMove,\n  styles,\n  WizardOptions,\n  cloneElement,\n} from './foundation.js';\nimport './bay-editor.js';\nimport { BayEditor } from './bay-editor.js';\nimport { editlNode } from './lnodewizard.js';\nimport { SubstationEditor } from './substation-editor.js';\n\n/** Initial attribute values suggested for `VoltageLevel` creation */\nconst initial = {\n  nomFreq: '50',\n  numPhases: '3',\n  Voltage: '110',\n  multiplier: 'k',\n};\n\nfunction getVoltageAction(\n  oldVoltage: Element | null,\n  Voltage: string | null,\n  multiplier: string | null,\n  voltageLevel: Element\n): EditorAction {\n  if (oldVoltage === null) {\n    const element = createElement(voltageLevel.ownerDocument, 'Voltage', {\n      unit: 'V',\n      multiplier,\n    });\n    element.textContent = Voltage;\n    return {\n      new: {\n        parent: voltageLevel,\n        element,\n        reference: voltageLevel.firstElementChild,\n      },\n    };\n  }\n\n  if (Voltage === null)\n    return {\n      old: {\n        parent: voltageLevel,\n        element: oldVoltage,\n        reference: oldVoltage.nextElementSibling,\n      },\n    };\n\n  const newVoltage = <Element>oldVoltage.cloneNode(false);\n  newVoltage.textContent = Voltage;\n  if (multiplier === null) newVoltage.removeAttribute('multiplier');\n  else newVoltage.setAttribute('multiplier', multiplier);\n  return {\n    old: { element: oldVoltage },\n    new: { element: newVoltage },\n  };\n}\n\n/** [[`Substation`]] subeditor for a `VoltageLevel` element. */\n@customElement('voltage-level-editor')\nexport class VoltageLevelEditor extends LitElement {\n  @property()\n  element!: Element;\n\n  @property()\n  get name(): string {\n    return this.element.getAttribute('name') ?? '';\n  }\n  @property()\n  get desc(): string | null {\n    return this.element.getAttribute('desc') ?? null;\n  }\n  @property()\n  get voltage(): string | null {\n    const V = this.element.querySelector(selectors.VoltageLevel + ' > Voltage');\n    if (V === null) return null;\n    const v = V.textContent ?? '';\n    const m = V.getAttribute('multiplier');\n    const u = m === null ? 'V' : ' ' + m + 'V';\n    return v ? v + u : null;\n  }\n\n  openEditWizard(): void {\n    this.dispatchEvent(\n      newWizardEvent(VoltageLevelEditor.wizard({ element: this.element }))\n    );\n  }\n\n  openBayWizard(): void {\n    this.dispatchEvent(\n      newWizardEvent(BayEditor.wizard({ parent: this.element }))\n    );\n  }\n\n  openLNodeWizard(): void {\n    this.dispatchEvent(newWizardEvent(editlNode(this.element)));\n  }\n\n  remove(): void {\n    if (this.element)\n      this.dispatchEvent(\n        newActionEvent({\n          old: {\n            parent: this.element.parentElement!,\n            element: this.element,\n            reference: this.element.nextElementSibling,\n          },\n        })\n      );\n  }\n\n  renderHeader(): TemplateResult {\n    return html`<h2>\n      ${this.name} ${this.desc === null ? '' : html`&mdash;`} ${this.desc}\n      ${this.voltage === null ? '' : html`(${this.voltage})`}\n      <abbr title=\"${translate('add')}\">\n        <mwc-icon-button\n          icon=\"playlist_add\"\n          @click=${() => this.openBayWizard()}\n        ></mwc-icon-button>\n      </abbr>\n      <nav>\n        <abbr title=\"${translate('lnode.tooltip')}\">\n          <mwc-icon-button\n            icon=\"account_tree\"\n            @click=${() => this.openLNodeWizard()}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('duplicate')}\">\n          <mwc-icon-button\n            icon=\"content_copy\"\n            @click=${() => cloneElement(this)}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('edit')}\">\n          <mwc-icon-button\n            icon=\"edit\"\n            @click=${() => this.openEditWizard()}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('move')}\">\n          <mwc-icon-button\n            icon=\"forward\"\n            @click=${() =>\n              startMove(this, VoltageLevelEditor, SubstationEditor)}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('remove')}\">\n          <mwc-icon-button\n            icon=\"delete\"\n            @click=${() => this.remove()}\n          ></mwc-icon-button>\n        </abbr>\n      </nav>\n    </h2>`;\n  }\n\n  render(): TemplateResult {\n    return html`<section tabindex=\"0\">\n      ${this.renderHeader()}\n      <div id=\"bayContainer\">\n        ${Array.from(this.element?.querySelectorAll(selectors.Bay) ?? []).map(\n          bay => html`<bay-editor .element=${bay}></bay-editor>`\n        )}\n      </div>\n    </section>`;\n  }\n\n  static updateAction(element: Element): WizardActor {\n    return (inputs: WizardInput[]): EditorAction[] => {\n      const name = inputs.find(i => i.label === 'name')!.value;\n      const desc = getValue(inputs.find(i => i.label === 'desc')!);\n      const nomFreq = getValue(inputs.find(i => i.label === 'nomFreq')!);\n      const numPhases = getValue(inputs.find(i => i.label === 'numPhases')!);\n      const Voltage = getValue(inputs.find(i => i.label === 'Voltage')!);\n      const multiplier = getMultiplier(\n        inputs.find(i => i.label === 'Voltage')!\n      );\n\n      let voltageLevelAction: EditorAction | null;\n      let voltageAction: EditorAction | null;\n\n      if (\n        name === element.getAttribute('name') &&\n        desc === element.getAttribute('desc') &&\n        nomFreq === element.getAttribute('nomFreq') &&\n        numPhases === element.getAttribute('numPhases')\n      ) {\n        voltageLevelAction = null;\n      } else {\n        const newElement = <Element>element.cloneNode(false);\n        newElement.setAttribute('name', name);\n        if (desc === null) newElement.removeAttribute('desc');\n        else newElement.setAttribute('desc', desc);\n        if (nomFreq === null) newElement.removeAttribute('nomFreq');\n        else newElement.setAttribute('nomFreq', nomFreq);\n        if (numPhases === null) newElement.removeAttribute('numPhases');\n        else newElement.setAttribute('numPhases', numPhases);\n        voltageLevelAction = { old: { element }, new: { element: newElement } };\n      }\n\n      if (\n        Voltage ===\n          (element\n            .querySelector('VoltageLevel > Voltage')\n            ?.textContent?.trim() ?? null) &&\n        multiplier ===\n          (element\n            .querySelector('VoltageLevel > Voltage')\n            ?.getAttribute('multiplier') ?? null)\n      ) {\n        voltageAction = null;\n      } else {\n        voltageAction = getVoltageAction(\n          element.querySelector('VoltageLevel > Voltage'),\n          Voltage,\n          multiplier,\n          voltageLevelAction?.new.element ?? element\n        );\n      }\n\n      const actions: EditorAction[] = [];\n      if (voltageLevelAction) actions.push(voltageLevelAction);\n      if (voltageAction) actions.push(voltageAction);\n      return actions;\n    };\n  }\n\n  static createAction(parent: Element): WizardActor {\n    return (inputs: WizardInput[]): EditorAction[] => {\n      const name = getValue(inputs.find(i => i.label === 'name')!);\n      const desc = getValue(inputs.find(i => i.label === 'desc')!);\n      const nomFreq = getValue(inputs.find(i => i.label === 'nomFreq')!);\n      const numPhases = getValue(inputs.find(i => i.label === 'numPhases')!);\n      const Voltage = getValue(inputs.find(i => i.label === 'Voltage')!);\n      const multiplier = getMultiplier(\n        inputs.find(i => i.label === 'Voltage')!\n      );\n\n      const element = createElement(parent.ownerDocument, 'VoltageLevel', {\n        name,\n        desc,\n        nomFreq,\n        numPhases,\n      });\n\n      if (Voltage !== null) {\n        const voltageElement = createElement(parent.ownerDocument, 'Voltage', {\n          unit: 'V',\n          multiplier,\n        });\n        voltageElement.textContent = Voltage;\n        element.appendChild(voltageElement);\n      }\n\n      return [\n        {\n          new: {\n            parent,\n            element,\n            reference: getReference(parent, 'VoltageLevel'),\n          },\n        },\n      ];\n    };\n  }\n\n  static wizard(options: WizardOptions): Wizard {\n    const [\n      heading,\n      actionName,\n      actionIcon,\n      action,\n      name,\n      desc,\n      nomFreq,\n      numPhases,\n      Voltage,\n      multiplier,\n    ] = isCreateOptions(options)\n      ? [\n          get('voltagelevel.wizard.title.add'),\n          get('add'),\n          'add',\n          VoltageLevelEditor.createAction(options.parent),\n          '',\n          '',\n          initial.nomFreq,\n          initial.numPhases,\n          initial.Voltage,\n          initial.multiplier,\n        ]\n      : [\n          get('voltagelevel.wizard.title.edit'),\n          get('save'),\n          'edit',\n          VoltageLevelEditor.updateAction(options.element),\n          options.element.getAttribute('name'),\n          options.element.getAttribute('desc'),\n          options.element.getAttribute('nomFreq'),\n          options.element.getAttribute('numPhases'),\n          options.element\n            .querySelector('VoltageLevel > Voltage')\n            ?.textContent?.trim() ?? null,\n          options.element\n            .querySelector('VoltageLevel > Voltage')\n            ?.getAttribute('multiplier') ?? null,\n        ];\n\n    return [\n      {\n        title: heading,\n        primary: {\n          icon: actionIcon,\n          label: actionName,\n          action: action,\n        },\n        content: [\n          html`<wizard-textfield\n            label=\"name\"\n            .maybeValue=${name}\n            helper=\"${translate('voltagelevel.wizard.nameHelper')}\"\n            required\n            validationMessage=\"${translate('textfield.required')}\"\n            dialogInitialFocus\n          ></wizard-textfield>`,\n          html`<wizard-textfield\n            label=\"desc\"\n            .maybeValue=${desc}\n            nullable\n            helper=\"${translate('voltagelevel.wizard.descHelper')}\"\n          ></wizard-textfield>`,\n          html`<wizard-textfield\n            label=\"nomFreq\"\n            .maybeValue=${nomFreq}\n            nullable\n            helper=\"${translate('voltagelevel.wizard.nomFreqHelper')}\"\n            suffix=\"Hz\"\n            required\n            validationMessage=\"${translate('textfield.nonempty')}\"\n            pattern=\"${patterns.unsigned}\"\n          ></wizard-textfield>`,\n          html`<wizard-textfield\n            label=\"numPhases\"\n            .maybeValue=${numPhases}\n            nullable\n            helper=\"${translate('voltagelevel.wizard.numPhaseHelper')}\"\n            suffix=\"#\"\n            required\n            validationMessage=\"${translate('textfield.nonempty')}\"\n            type=\"number\"\n            min=\"1\"\n            max=\"255\"\n          ></wizard-textfield>`,\n          html`<wizard-textfield\n            label=\"Voltage\"\n            .maybeValue=${Voltage}\n            nullable\n            unit=\"V\"\n            .multipliers=${[null, 'G', 'M', 'k', '', 'm']}\n            .multiplier=${multiplier}\n            helper=\"${translate('voltagelevel.wizard.voltageHelper')}\"\n            required\n            validationMessage=\"${translate('textfield.nonempty')}\"\n            pattern=\"${patterns.decimal}\"\n          ></wizard-textfield>`,\n        ],\n      },\n    ];\n  }\n\n  static styles = css`\n    ${styles}\n\n    section {\n      background-color: var(--mdc-theme-on-primary);\n    }\n\n    #bayContainer {\n      display: grid;\n      grid-gap: 12px;\n      padding: 8px 12px 16px;\n      box-sizing: border-box;\n      grid-template-columns: repeat(auto-fit, minmax(316px, auto));\n    }\n\n    @media (max-width: 387px) {\n      #bayContainer {\n        grid-template-columns: repeat(auto-fit, minmax(196px, auto));\n      }\n    }\n  `;\n}\n"]}