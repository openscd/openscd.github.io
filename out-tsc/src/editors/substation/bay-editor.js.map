{"version":3,"file":"bay-editor.js","sourceRoot":"","sources":["../../../../src/editors/substation/bay-editor.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  css,\n  customElement,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n} from 'lit-element';\nimport { translate, get } from 'lit-translate';\n\nimport {\n  createElement,\n  EditorAction,\n  getReference,\n  getValue,\n  newActionEvent,\n  newWizardEvent,\n  Wizard,\n  WizardActor,\n  WizardInput,\n} from '../../foundation.js';\n\nimport {\n  isCreateOptions,\n  startMove,\n  styles,\n  updateNamingAction,\n  WizardOptions,\n  cloneElement,\n} from './foundation.js';\nimport './conducting-equipment-editor.js';\nimport { ConductingEquipmentEditor } from './conducting-equipment-editor.js';\nimport { editlNode } from './lnodewizard.js';\nimport { VoltageLevelEditor } from './voltage-level-editor.js';\n\n/** [[`SubstationEditor`]] subeditor for a `Bay` element. */\n@customElement('bay-editor')\nexport class BayEditor extends LitElement {\n  @property()\n  element!: Element;\n\n  @property({ type: String })\n  get name(): string {\n    return this.element.getAttribute('name') ?? '';\n  }\n  @property({ type: String })\n  get desc(): string | null {\n    return this.element.getAttribute('desc') ?? null;\n  }\n\n  openEditWizard(): void {\n    this.dispatchEvent(\n      newWizardEvent(BayEditor.wizard({ element: this.element }))\n    );\n  }\n\n  openConductingEquipmentWizard(): void {\n    if (!this.element) return;\n    const event = newWizardEvent(\n      ConductingEquipmentEditor.wizard({ parent: this.element })\n    );\n    this.dispatchEvent(event);\n  }\n\n  openLNodeWizard(): void {\n    this.dispatchEvent(newWizardEvent(editlNode(this.element)));\n  }\n\n  remove(): void {\n    if (this.element)\n      this.dispatchEvent(\n        newActionEvent({\n          old: {\n            parent: this.element.parentElement!,\n            element: this.element,\n            reference: this.element.nextElementSibling,\n          },\n        })\n      );\n  }\n\n  renderHeader(): TemplateResult {\n    return html`<h3>\n      ${this.name} ${this.desc === null ? '' : html`&mdash;`} ${this.desc}\n      <abbr title=\"${translate('add')}\">\n        <mwc-icon-button\n          icon=\"playlist_add\"\n          @click=${() => this.openConductingEquipmentWizard()}\n        ></mwc-icon-button>\n      </abbr>\n      <nav>\n        <abbr title=\"${translate('lnode.tooltip')}\">\n          <mwc-icon-button\n            icon=\"account_tree\"\n            @click=\"${() => this.openLNodeWizard()}\"\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('duplicate')}\">\n          <mwc-icon-button\n            icon=\"content_copy\"\n            @click=${() => cloneElement(this)}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('edit')}\">\n          <mwc-icon-button\n            icon=\"edit\"\n            @click=${() => this.openEditWizard()}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('move')}\">\n          <mwc-icon-button\n            icon=\"forward\"\n            @click=${() => startMove(this, BayEditor, VoltageLevelEditor)}\n          ></mwc-icon-button>\n        </abbr>\n        <abbr title=\"${translate('remove')}\">\n          <mwc-icon-button\n            icon=\"delete\"\n            @click=${() => this.remove()}\n          ></mwc-icon-button>\n        </abbr>\n      </nav>\n    </h3>`;\n  }\n\n  render(): TemplateResult {\n    return html`<section tabindex=\"0\">\n      ${this.renderHeader()}\n      <div id=\"ceContainer\">\n        ${Array.from(\n          this.element?.querySelectorAll(\n            ':root > Substation > VoltageLevel > Bay > ConductingEquipment'\n          ) ?? []\n        ).map(\n          voltageLevel =>\n            html`<conducting-equipment-editor\n              .element=${voltageLevel}\n            ></conducting-equipment-editor>`\n        )}\n      </div>\n    </section> `;\n  }\n\n  static createAction(parent: Element): WizardActor {\n    return (inputs: WizardInput[]): EditorAction[] => {\n      const name = getValue(inputs.find(i => i.label === 'name')!);\n      const desc = getValue(inputs.find(i => i.label === 'desc')!);\n      const element = createElement(parent.ownerDocument, 'Bay', {\n        name,\n        desc,\n      });\n\n      const action = {\n        new: {\n          parent,\n          element,\n          reference: getReference(parent, 'Bay'),\n        },\n      };\n\n      return [action];\n    };\n  }\n\n  static wizard(options: WizardOptions): Wizard {\n    const [\n      heading,\n      actionName,\n      actionIcon,\n      action,\n      name,\n      desc,\n    ] = isCreateOptions(options)\n      ? [\n          get('bay.wizard.title.add'),\n          get('add'),\n          'add',\n          BayEditor.createAction(options.parent),\n          '',\n          '',\n        ]\n      : [\n          get('bay.wizard.title.edit'),\n          get('save'),\n          'edit',\n          updateNamingAction(options.element),\n          options.element.getAttribute('name'),\n          options.element.getAttribute('desc'),\n        ];\n\n    return [\n      {\n        title: heading,\n        primary: {\n          icon: actionIcon,\n          label: actionName,\n          action: action,\n        },\n        content: [\n          html`<wizard-textfield\n            label=\"name\"\n            .maybeValue=${name}\n            helper=\"${translate('bay.wizard.nameHelper')}\"\n            required\n            validationMessage=\"${translate('textfield.required')}\"\n            dialogInitialFocus\n          ></wizard-textfield>`,\n          html`<wizard-textfield\n            label=\"desc\"\n            .maybeValue=${desc}\n            nullable\n            helper=\"${translate('bay.wizard.descHelper')}\"\n          ></wizard-textfield>`,\n        ],\n      },\n    ];\n  }\n\n  static styles = css`\n    ${styles}\n\n    section {\n      margin: 0px;\n    }\n\n    #ceContainer {\n      display: grid;\n      grid-gap: 12px;\n      padding: 12px;\n      box-sizing: border-box;\n      grid-template-columns: repeat(auto-fit, minmax(64px, auto));\n    }\n  `;\n}\n"]}