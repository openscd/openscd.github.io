{"version":3,"file":"conducting-equipment-editor.js","sourceRoot":"","sources":["../../../src/zeroline/conducting-equipment-editor.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  css,\n  customElement,\n  html,\n  LitElement,\n  property,\n  TemplateResult,\n} from 'lit-element';\n\nimport { startMove } from './foundation.js';\nimport { newActionEvent, newWizardEvent } from '../foundation.js';\n\nimport {\n  circuitBreakerIcon,\n  currentTransformerIcon,\n  disconnectorIcon,\n  earthSwitchIcon,\n  generalConductingEquipmentIcon,\n  voltageTransformerIcon,\n} from '../icons.js';\n\nimport { BayEditor } from './bay-editor.js';\nimport { wizards } from '../wizards/wizard-library.js';\n\nfunction typeStr(condEq: Element): string {\n  return condEq.getAttribute('type') === 'DIS' &&\n    condEq.querySelector('Terminal')?.getAttribute('cNodeName') === 'grounded'\n    ? 'ERS'\n    : condEq.getAttribute('type') ?? '';\n}\n\nconst typeIcons: Partial<Record<string, TemplateResult>> = {\n  CBR: circuitBreakerIcon,\n  DIS: disconnectorIcon,\n  CTR: currentTransformerIcon,\n  VTR: voltageTransformerIcon,\n  ERS: earthSwitchIcon,\n};\n\nexport function typeIcon(condEq: Element): TemplateResult {\n  return typeIcons[typeStr(condEq)] ?? generalConductingEquipmentIcon;\n}\n\n/** [[`SubstationEditor`]] subeditor for a `ConductingEquipment` element. */\n@customElement('conducting-equipment-editor')\nexport class ConductingEquipmentEditor extends LitElement {\n  @property({ type: Element })\n  element!: Element;\n\n  @property({ type: Boolean })\n  readonly = false;\n\n  @property({ type: String })\n  get name(): string {\n    return this.element.getAttribute('name') ?? '';\n  }\n\n  openEditWizard(): void {\n    const wizard = wizards['ConductingEquipment'].edit(this.element);\n    if (wizard) this.dispatchEvent(newWizardEvent(wizard));\n  }\n\n  /** Opens a [[`WizardDialog`]] for editing `LNode` connections. */\n  openLNodeWizard(): void {\n    const wizard = wizards['LNode'].edit(this.element);\n    if (wizard) this.dispatchEvent(newWizardEvent(wizard));\n  }\n\n  remove(): void {\n    if (this.element)\n      this.dispatchEvent(\n        newActionEvent({\n          old: {\n            parent: this.element.parentElement!,\n            element: this.element,\n            reference: this.element.nextSibling,\n          },\n        })\n      );\n  }\n\n  render(): TemplateResult {\n    return html`\n      <div id=\"container\" tabindex=\"0\">\n        ${typeIcon(this.element)}\n        ${this.readonly\n          ? html``\n          : html`<mwc-fab\n                mini\n                class=\"menu-item left\"\n                @click=\"${() => this.openLNodeWizard()}\"\n                icon=\"account_tree\"\n              ></mwc-fab>\n              <mwc-fab\n                mini\n                class=\"menu-item up\"\n                icon=\"edit\"\n                @click=\"${() => this.openEditWizard()}}\"\n              ></mwc-fab>\n              <mwc-fab\n                mini\n                class=\"menu-item right\"\n                @click=\"${() =>\n                  startMove(this, ConductingEquipmentEditor, BayEditor)}\"\n                icon=\"forward\"\n              ></mwc-fab>\n              <mwc-fab\n                mini\n                class=\"menu-item down\"\n                icon=\"delete\"\n                @click=\"${() => this.remove()}}\"\n              ></mwc-fab>`}\n      </div>\n      <h4>${this.name}</h4>\n    `;\n  }\n\n  static styles = css`\n    #container {\n      color: var(--mdc-theme-on-surface);\n      width: 64px;\n      height: 64px;\n      margin: auto;\n      position: relative;\n      transition: all 200ms linear;\n    }\n\n    #container:focus {\n      outline: none;\n    }\n\n    #container > svg {\n      color: var(--mdc-theme-on-surface);\n      width: 64px;\n      height: 64px;\n      transition: transform 150ms linear, box-shadow 200ms linear;\n      outline-color: var(--mdc-theme-primary);\n      outline-style: solid;\n      outline-width: 0px;\n    }\n\n    #container:focus > svg {\n      box-shadow: 0 8px 10px 1px rgba(0, 0, 0, 0.14),\n        0 3px 14px 2px rgba(0, 0, 0, 0.12), 0 5px 5px -3px rgba(0, 0, 0, 0.2);\n    }\n\n    #container:hover > svg {\n      outline: 2px dashed var(--mdc-theme-primary);\n      transition: transform 200ms linear, box-shadow 250ms linear;\n    }\n\n    #container:focus-within > svg {\n      outline: 2px solid var(--mdc-theme-primary);\n      background: var(--mdc-theme-on-primary);\n      transform: scale(0.8);\n      transition: transform 200ms linear, box-shadow 250ms linear;\n    }\n\n    .menu-item {\n      color: var(--mdc-theme-on-surface);\n      transition: transform 200ms cubic-bezier(0.4, 0, 0.2, 1),\n        opacity 200ms linear;\n      position: absolute;\n      top: 8px;\n      left: 8px;\n      pointer-events: none;\n      z-index: 1;\n      opacity: 0;\n    }\n\n    #container:focus-within > .menu-item {\n      transition: transform 250ms cubic-bezier(0.4, 0, 0.2, 1),\n        opacity 250ms linear;\n      pointer-events: auto;\n      opacity: 1;\n    }\n\n    #container:focus-within > .menu-item.up {\n      transform: translate(0px, -52px);\n    }\n\n    #container:focus-within > .menu-item.down {\n      transform: translate(0px, 52px);\n    }\n\n    #container:focus-within > .menu-item.right {\n      transform: translate(52px, 0px);\n    }\n\n    #container:focus-within > .menu-item.left {\n      transform: translate(-52px, 0px);\n    }\n\n    h4 {\n      color: var(--mdc-theme-on-surface);\n      font-family: 'Roboto', sans-serif;\n      font-weight: 300;\n      overflow: hidden;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      margin: 0px;\n      opacity: 1;\n      transition: opacity 200ms linear;\n      text-align: center;\n    }\n\n    :host(.moving) #container,\n    :host(.moving) h4 {\n      opacity: 0.3;\n    }\n  `;\n}\n"]}